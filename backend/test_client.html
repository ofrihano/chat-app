<!DOCTYPE html>
<html>
    <head>
        <title>Chat Test</title>
        <style>
            body { font-family: sans-serif; padding: 20px; }
            #messages { border: 1px solid #ddd; height: 300px; overflow-y: scroll; padding: 10px; margin-bottom: 10px; }
            .message { margin: 5px 0; }
        </style>
    </head>
    <body>
        <h2>WebSocket Chat Tester</h2>
        
        <label>Room ID: <input type="text" id="roomId" value="general"/></label>
        <button onclick="connect()">Connect</button>
        <span id="status" style="color: red; margin-left: 10px;">Disconnected</span>

        <div id="messages"></div>

        <input type="text" id="messageText" placeholder="Type a message..." disabled/>
        <button id="sendBtn" onclick="sendMessage()" disabled>Send</button>

        <script>
            var ws = null;

            function connect() {
                var roomId = document.getElementById("roomId").value;
                var url = "ws://localhost:8000/ws/" + roomId; // connecting to your FastAPI backend
                
                ws = new WebSocket(url);

                ws.onopen = function() {
                    document.getElementById("status").innerText = "Connected to " + roomId;
                    document.getElementById("status").style.color = "green";
                    document.getElementById("messageText").disabled = false;
                    document.getElementById("sendBtn").disabled = false;
                };

                ws.onmessage = function(event) {
                    var messages = document.getElementById('messages');
                    var message = document.createElement('div');
                    message.className = 'message';
                    message.innerText = event.data; // The text sent from the server
                    messages.appendChild(message);
                    messages.scrollTop = messages.scrollHeight; // Auto-scroll to bottom
                };

                ws.onclose = function() {
                    document.getElementById("status").innerText = "Disconnected";
                    document.getElementById("status").style.color = "red";
                };
            }

            function sendMessage() {
                var input = document.getElementById("messageText");
                ws.send(input.value);
                input.value = ''; // Clear input after sending
            }
        </script>
    </body>
</html>